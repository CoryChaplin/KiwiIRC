<!-- Plugin by Cory Chaplin (elephantman@europnet.org) - http://www.europnet.org - 09/2015 -->
<script type="text/html" id="tmpl_navbar">
    <div class="navbar" id="navbar">
        <a class="logo" href="<%= logo_link %>" target="_blank">
            <img src="/assets/plugins/images/<%= logo_file %>" height="50" alt="<%= logo_title %>" title=="<%= logo_title %>">
        </a>
        <div class="social">
            <div id="fb-root"></div>
            <div class="fb-like" data-href="<%= facebook_url %>" data-send="false" data-layout="button_count" data-width="140" data-show-faces="false" data-action="recommend"></div>
        </div>
    </div>
</script>


<style>
    #navbar {
        margin: 0;
        padding-left: 0;
        padding-right: 0;
        border-width: 0;
        border-radius: 0;
        -webkit-box-shadow: none;
        box-shadow: none;
        min-height: 50px;
        background: #3071a9;
    }
    #navbar .logo {
        height: 50px;
        position: relative;
        display: block;
        width: 150px;
        float: left;
        margin-left: 10px;
    }
    #navbar .social {
        float: right;
        width: 380px;
        padding: 15px 10px 0 0;
        margin-right: 20px;
    }
    #navbar .fb-like {
        float: right;
        padding-bottom: 4px;
        padding-right: 10px;
        z-index: 2;
    }
    #kiwi {clear: both;}
</style>

<script>
kiwi.plugins.on('loaded', function() {
    var locale_strings,
        text,
        locale;


    locale_strings = {
        'en': {
            "navbar" : {
                "" : {
                    "domain" : "navbar",
                    "lang" : "en"
                },
                "play" : [ null, "Play" ],
                "stop" : [ null, "Stop" ],
                "mute" : [ null, "Mute" ],
                "unmute" : [ null, "Unmute" ]
            }
        },

       'fr': {
            "navbar" : {
                "" : {
                    "domain" : "navbar",
                    "lang" : "fr"
                },
                "play" : [ null, "Lecture" ],
                "stop" : [ null, "Stop" ],
                "mute" : [ null, "Muet" ],
                "unmute" : [ null, "Son" ]
            }
        }
    };
    

	(function () {
        var Navbar = Backbone.View.extend({
            initialize: function (options) {
                var origin = getQueryVariable('origine');

                // Create a new JED instance
                this.locale = new Jed({
                    "domain" : "navbar",
                    "missing_key_callback" : function(key) {
                        console.error('[Jed] missing_key_callback:' + key);
                    },
                    "locale_data" : locale_strings[kiwi.i18n._textdomain] || locale_strings['en']
                });

                this.text = {
                    play: this.locale.translate('play').fetch(),
                    stop: this.locale.translate('stop').fetch(),
                    mute: this.locale.translate('mute').fetch(),
                    unmute: this.locale.translate('unmute').fetch()
                };

                if(origin == 3 || origin == 7) {
                    this.text['logo_link'] = 'http://www.chat-fr.org/';
                    this.text['logo_file'] = 'logo-cfr.png';
                    this.text['logo_title'] = 'Chat-fr';
                    this.text['facebook_url'] = 'https://www.facebook.com/EuropNet/160252764002584';

                } else {
                    this.text['logo_link'] = 'http://www.europnet.org/';
                    this.text['logo_file'] = 'logo-en-white.png';
                    this.text['logo_title'] = 'EuropNet';
                    this.text['facebook_url'] = 'https://www.facebook.com/EuropNet/160252764002584';
                }
            },

            render: function() {
                this.$el = $(_.template($('#tmpl_navbar').html())(this.text));
                return this;
            },

            calculateKiwiHeight: function(bar_height) {
                return $(window).height() - bar_height;
            },

        });

        var nav = new Navbar(),
            nav_dom,
            kiwi_height;

        nav_dom = nav.render().$el;
        $('#kiwi').before(nav_dom);
        //nav.render().$el.prependTo($('#kiwi'));


        // Adjust kiwi size on load
        $('#kiwi').height(nav.calculateKiwiHeight(nav_dom.height()));
        // Adjust kiwi size on window resize
        $(window).resize(function() {
            if($(window).width() > 700) {
                $('#kiwi').height(nav.calculateKiwiHeight(nav_dom.height()));
            } else {
                nav_dom.hide();
            }
        });
    })();
});
</script> 
<script type="text/javascript">
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/fr_FR/sdk.js#xfbml=1&version=v2.4&appId=292727577526632";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>